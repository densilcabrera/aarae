function fun=StruveH0(z)
%
% StruveH0 calculates the function StruveH0 for complex argument z
%
% Author : T.P. Theodoulidis
% Date   : 11 June 2012
%
% Arguments
% z : can be scalar, vector, matrix
% 
% External routines called         : cheval, StruveH0Y0
% Matlab intrinsic routines called : bessely, besselh
%
bn=[...
 7.741208505217204e-002 -1.489049907224780e-001  1.365908688119806e-001...
-1.244408977167160e-001  1.213210541746413e-001 -9.902285991131098e-002...
 9.285469594924457e-002 -8.889396057027860e-002  6.318108596562945e-002...
-3.164140591816664e-002  1.160282350916835e-002 -3.255171535152174e-003...
 7.240935462046915e-004 -1.313122517655078e-004  1.984234861137538e-005...
-2.542464986238115e-006  2.802187746192928e-007 -2.688335553599889e-008...
 2.267665290294826e-009 -1.696387437431367e-010  1.133879020090459e-011...
-6.816279772928244e-013  3.706645666482425e-014 -1.832769429508806e-015...
 8.278232328724399e-017 -3.429926823742390e-018  1.308568653462734e-019...
-4.612908468868213e-021  1.507287730295555e-022 -4.578534841587558e-024...
 1.296387199302720e-025 -3.430073819717729e-027  8.500386329076394e-029...
-1.977322978489543e-030  4.326093533645215e-032];
%
x=z(:);
%
% |x|<=16
i1=abs(x)<=16;
x1=x(i1);
if isempty(x1)==0
    z1=x1.^2/400;
    fun1=cheval('shifted',bn,z1)*2.*x1/pi;
else
    fun1=[];
end
%
% |x|>16
i2=abs(x)>16;
x2=x(i2);
if isempty(x2)==0
    fun2=StruveH0Y0(x2)+bessely(0,x2);
else
    fun2=[];
end
%
fun=x*0;
fun(i1)=fun1;
fun(i2)=fun2;
%
fun=reshape(fun,size(z));
%